<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper SYSTEM "mybatis-3-mapper.dtd">
<mapper namespace="co.yedam.restaurant.mapper.RestaurantMapper">

	<select id="selectAllList"
		resultType="co.yedam.restaurant.service.RestaurantVO">
		SELECT * FROM RESTAURANT ORDER BY LIKECNT, STARCNT DESC
	</select>
	
	<select id="selectRandomList" resultType="co.yedam.restaurant.service.RestaurantVO">
		SELECT * FROM (SELECT * FROM (SELECT * FROM RESTAURANT WHERE STARCNT &gt;= 4) ORDER BY DBMS_RANDOM.VALUE) WHERE ROWNUM &lt;= 8
	</select>

	<select id="selectCategory"
		resultType="co.yedam.restaurant.service.RestaurantVO">
		SELECT * FROM (SELECT * FROM RESTAURANT WHERE RS_CATEGORY = #{category} ORDER BY LIKECNT, STARCNT DESC) WHERE ROWNUM &lt;= 8
	</select>

	<select id="selectAddress"
		resultType="co.yedam.restaurant.service.RestaurantVO">
		SELECT * FROM (SELECT * FROM RESTAURANT WHERE RS_GU = #{address} ORDER BY LIKECNT, STARCNT DESC) WHERE ROWNUM &lt;= 8
	</select>
	
	<select id="selectSearch" resultType="co.yedam.restaurant.service.RestaurantVO">
		SELECT * FROM RESTAURANT WHERE RS_NAME LIKE '%'||#{word}||'%' OR RS_GU LIKE '%'||#{word}||'%'
	</select>

	<select id="getRestaurant"
		resultType="co.yedam.restaurant.service.RestaurantVO">
		SELECT * FROM RESTAURANT WHERE RS_CODE = #{rcode}
	</select>
	
	<select id="getResCountByLike">
		SELECT RS_NAME "RESTAURANT_NAME", LIKECNT FROM RESTAURANT ORDER BY LIKECNT DESC FETCH FIRST 10 ROWS ONLY
	</select>

	<!-- 예약등록 -->
 	<insert id="getReser" parameterType="co.yedam.restaurant.service.ReservationVO"> 
 	INSERT INTO RESERVATION (user_id, rs_code,nickname, res_date ,res_time, buyAble )
 	values(#{userId}, #{rsCode}, #{nickname}, #{resDate}, #{resTime}, #{buyAble})
	</insert> 
	
	<!-- 예약하면 마이 페이지에 보여주는 리스트 -->
	<select id="reservationAll"
		resultType="co.yedam.restaurant.service.ReservationVO">
		SELECT * FROM RESERVATION where USER_ID = #{userId}
	</select>

</mapper>